<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ZikrMate â€“ Global Remembrance</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<link rel="icon" type="image/jpeg" href="ZikrMate_Logo.jpeg">

<style>
*{box-sizing:border-box;margin:0;padding:0}

body{
  height:100vh;
  overflow:hidden;
  font-family:"Segoe UI", Roboto, sans-serif;
  background:radial-gradient(circle at top,#102a43,#0b1e2d 70%);
  color:#e6f1ff;
  display:flex;
  flex-direction:column;
  position:relative;
}

body.ramadan{
  background:radial-gradient(circle at top,#0b1e40,#050d1f 70%);
}

/* Pattern */
.pattern{
  position:absolute;
  inset:0;
  background-image:url("https://www.transparenttextures.com/patterns/arabesque.png");
  opacity:.03;
  z-index:0;
}

/* Stars */
.stars{position:absolute;inset:0;z-index:0}
.star{
  position:absolute;width:2px;height:2px;
  background:white;border-radius:50%;
  opacity:.6;
  animation:twinkle 3s infinite alternate;
}
@keyframes twinkle{from{opacity:.2}to{opacity:.8}}

/* Logo */
.logo-container{
  position:absolute;
  top:30px;right:40px;
  z-index:2;
  opacity:.9;
}
.logo-container img{
  width:70px;
  filter:drop-shadow(0 0 12px rgba(61,169,252,.35));
}

/* Header */
header{
  text-align:center;
  padding:60px 20px 20px;
  z-index:2;
}

.live-indicator{
  display:inline-flex;
  align-items:center;
  gap:6px;
  font-size:12px;
  color:#3da9fc;
}
.live-dot{
  width:8px;height:8px;
  background:#3da9fc;
  border-radius:50%;
  animation:pulse 1.5s infinite;
}
@keyframes pulse{
  0%{box-shadow:0 0 0 0 rgba(61,169,252,.6)}
  70%{box-shadow:0 0 0 8px rgba(61,169,252,0)}
  100%{box-shadow:0 0 0 0 rgba(61,169,252,0)}
}

.hijri{margin-top:6px;font-size:13px;color:#9bbbd4}

.main-counter{
  font-size:64px;
  font-weight:600;
  margin-top:15px;
  text-shadow:0 0 18px rgba(61,169,252,.25);
}

.blessing{
  margin-top:14px;
  font-size:14px;
  opacity:.85;
}

/* Layout */
.layout{
  flex:1;
  display:grid;
  grid-template-columns:1.2fr 1fr;
  gap:30px;
  padding:0 60px 40px;
  max-width:1400px;
  margin:auto;
  width:100%;
  z-index:2;
}

/* Panels */
.panel{
  background:rgba(255,255,255,.04);
  border-radius:18px;
  backdrop-filter:blur(18px);
  border:1px solid rgba(61,169,252,.15);
  padding:28px;
  opacity:0;
  transform:translateY(20px);
  transition:.7s ease;
}
.panel.visible{opacity:1;transform:translateY(0)}

.panel h2{
  font-size:13px;
  text-transform:uppercase;
  letter-spacing:2px;
  color:#3da9fc;
  margin-bottom:22px;
}

/* Stats */
.stats-grid{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:16px;
}
.stat-card{
  background:rgba(255,255,255,.03);
  padding:16px;
  border-radius:14px;
}
.stat-card strong{font-size:12px;color:#9bbbd4}
.stat-card span{display:block;margin-top:6px;font-size:18px;font-weight:600}

/* Progress */
.progress-bar{
  height:8px;
  background:rgba(255,255,255,.1);
  border-radius:10px;
  overflow:hidden;
  margin-top:14px;
}
.progress-fill{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#3da9fc,#1f7ed6);
  transition:width .8s ease;
  box-shadow:0 0 12px rgba(61,169,252,.5);
}

/* Leaderboard */
#leaderboardContainer{
  display:flex;
  flex-direction:column;
  gap:12px;
}

.leaderboard-row{
  display:grid;
  grid-template-columns:70px 1fr 120px 100px;
  align-items:center;
  padding:14px 18px;
  border-radius:14px;
  background:rgba(255,255,255,.03);
  border:1px solid rgba(61,169,252,.08);
  opacity:0;
  transform:translateY(15px);
  animation:fadeUp .5s ease forwards;
}
@keyframes fadeUp{to{opacity:1;transform:translateY(0)}}

.leaderboard-row.top1{
  background:linear-gradient(90deg,rgba(61,169,252,.18),rgba(61,169,252,.05));
  border:1px solid rgba(61,169,252,.45);
}

.rank{font-weight:600;color:#9bbbd4}
.medal{font-size:18px}
.streak{font-size:12px;color:#7ec8ff}
.score{text-align:right;font-weight:600}

/* Footer */
footer{text-align:center;padding:20px;z-index:2}
.download-badge{height:50px}

@media(max-width:1100px){
  .layout{grid-template-columns:1fr;padding:0 20px 30px}
  body{overflow:auto}
  .main-counter{font-size:42px}
}
</style>
</head>

<body>

<div class="pattern"></div>
<div class="stars" id="stars"></div>

<div class="logo-container">
    <img src="ZikrMate_Logo.jpeg" alt="ZikrMate Logo">
</div>

<header>
  <div class="live-indicator">
    <div class="live-dot"></div> Live Updating
  </div>
  <div class="hijri" id="hijriDate"></div>
  <div class="main-counter" id="globalCounter">0</div>
  <div class="blessing" id="blessingText"></div>
</header>

<div class="layout">

  <div class="panel">
    <h2>Global Tasbeh Statistics</h2>
    <div class="stats-grid" id="statsContainer"></div>
  </div>

  <div style="display:flex;flex-direction:column;gap:30px">
    <div class="panel">
      <h2>Community Goal</h2>
      <div id="goalTitle"></div>
      <div id="goalNumbers" style="margin-top:8px;font-size:14px"></div>
      <div class="progress-bar"><div class="progress-fill" id="goalProgress"></div></div>
    </div>

    <div class="panel">
      <h2>Top Contributors This Month</h2>
      <div id="leaderboardContainer"></div>
    </div>
  </div>

</div>

<footer>
  <a href="https://play.google.com/store/apps/details?id=com.ahteshamtech.zikrmate" target="_blank">
    <img class="download-badge"
     src="https://upload.wikimedia.org/wikipedia/commons/7/78/Google_Play_Store_badge_EN.svg">
  </a>
</footer>

<script type="module">
import{initializeApp}from"https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import{getDatabase,ref,onValue,query,orderByChild,limitToLast}from"https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

const firebaseConfig={
 apiKey:"AIzaSyBrAE46NAujjWZz6kHGzFBlNGeEQTP48bQ",
 authDomain:"zikrmate-a4546.firebaseapp.com",
 databaseURL:"https://zikrmate-a4546-default-rtdb.firebaseio.com",
 projectId:"zikrmate-a4546"
};

const app=initializeApp(firebaseConfig);
const db=getDatabase(app);

const defaultTargets={
 "SubhanAllah":33,"Alhamdulillah":33,"Allahu Akbar":33,
 "SubhanAllahi wa bihamdihi":100,"Astaghfirullah":100,
 "La ilaha illallah":100,"Durood":10
};

/* Stars */
for(let i=0;i<80;i++){
 const s=document.createElement("div");
 s.className="star";
 s.style.left=Math.random()*100+"%";
 s.style.top=Math.random()*100+"%";
 s.style.animationDelay=Math.random()*3+"s";
 document.getElementById("stars").appendChild(s);
}

/* Hijri */
const d=new Date();
fetch(`https://api.aladhan.com/v1/gToH?date=${d.getDate()}-${d.getMonth()+1}-${d.getFullYear()}`)
.then(r=>r.json()).then(res=>{
 const h=res.data.hijri;
 document.getElementById("hijriDate").innerText=
  `${h.day} ${h.month.en} ${h.year} AH`;
 if(h.month.number===9) document.body.classList.add("ramadan");
});

/* Quotes */
const blessings=[
 "Verily, in the remembrance of Allah do hearts find rest.",
 "Every remembrance is light upon light.",
 "Consistency in zikr strengthens the soul."
];
const blessingEl=document.getElementById("blessingText");
function rotateBlessing(){
 blessingEl.style.opacity=0;
 setTimeout(()=>{
  blessingEl.innerText=blessings[Math.floor(Math.random()*blessings.length)];
  blessingEl.style.opacity=.85;
 },400);
}
rotateBlessing();
setInterval(rotateBlessing,6000);

/* Global Counter */
let prev=0;
const counter=document.getElementById("globalCounter");
function animate(start,end){
 let t0=null;
 function step(t){
  if(!t0)t0=t;
  const p=Math.min((t-t0)/1000,1);
  counter.innerText=Math.floor(p*(end-start)+start).toLocaleString();
  if(p<1)requestAnimationFrame(step);
 }
 requestAnimationFrame(step);
}

onValue(ref(db,"global_stats/predefined_counts"),snap=>{
 const data=snap.val(); if(!data)return;
 let total=0;
 const stats=document.getElementById("statsContainer");
 stats.innerHTML="";
 Object.keys(data).forEach(k=>{
  const exact=data[k]*(defaultTargets[k]||33);
  total+=exact;
  stats.innerHTML+=`
   <div class="stat-card"><strong>${k}</strong><span>${exact.toLocaleString()}</span></div>`;
 });
 animate(prev,total); prev=total;
});

/* Community Goal */
onValue(ref(db,"community_goal"),snap=>{
 const g=snap.val(); if(!g)return;
 document.getElementById("goalTitle").innerText=g.title;
 onValue(ref(db,"global_stats/predefined_counts/"+g.targetName),s=>{
  const exact=(s.val()||0)*(defaultTargets[g.targetName]||33);
  document.getElementById("goalNumbers").innerText=
   `${exact.toLocaleString()} / ${g.milestone.toLocaleString()}`;
  document.getElementById("goalProgress").style.width=
   Math.min((exact/g.milestone)*100,100)+"%";
 });
});

/* Leaderboard */
const m=new Date();
const key=m.getFullYear()+"_"+String(m.getMonth()+1).padStart(2,'0');
const lb=query(ref(db,"monthly_leaderboards/"+key),orderByChild("score"),limitToLast(5));

onValue(lb,snap=>{
 const data=snap.val();
 const c=document.getElementById("leaderboardContainer");
 c.innerHTML="";
 if(!data)return;
 Object.values(data).reverse().forEach((u,i)=>{
  const medal=["ðŸ¥‡","ðŸ¥ˆ","ðŸ¥‰"][i]||`#${i+1}`;
  c.innerHTML+=`
   <div class="leaderboard-row top${i+1}">
    <div class="rank"><span class="medal">${medal}</span></div>
    <div>${u.name}</div>
    <div class="streak">${u.streak?`ðŸ”¥ ${u.streak} days`:"â€”"}</div>
    <div class="score">${u.score.toLocaleString()}</div>
   </div>`;
 });
});

/* Animate Panels */
window.onload=()=>document.querySelectorAll(".panel").forEach(p=>p.classList.add("visible"));
</script>

</body>
</html>
